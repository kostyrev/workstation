---

- hosts: localhost
  become: true
  tasks:

    - name: creating .ssh directory
      action: file path={{ lookup('env','HOME') }}/.ssh owner={{ lookup('env','USER') }} group={{ lookup('env','USER') }} state=directory mode=0700

    - name: uploading ssh keys
      action: copy src=../files/ssh_authorized_keys/{{ lookup('env','USER') | lower }}.pub dest={{ lookup('env','HOME') }}/.ssh/authorized_keys owner={{ lookup('env','USER') }} group={{ lookup('env','USER') }} mode=0600

  roles:
    - willshersystems.sshd
    - franklinkim.vim
    - groks.repo-google

  post_tasks:
    - name: install google software
      yum: name={{ item }} state=latest
      with_items:
        - google-chrome-stable

    - name: "just install the packages with no configuration needed"
      action: "{{ ansible_pkg_mgr }} name={{ item }} state=present"
      with_items:
        - guake
